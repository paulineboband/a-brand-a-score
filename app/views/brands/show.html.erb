<div class="container-page">

  <div class="title-show">

    <div class="name-brand-fav">
      <div>
        <h1 class="brand-name-show"><%= @brand.name %></h1>
      </div>


      <div class="favorites-button">
        <% if @toggle == [] %>
          <%= link_to ('<i class="far fa-heart"></i>').html_safe, brand_favorites_path(@brand), method: :post %>
        <% else %>
          <i class="fas fa-heart"></i>
        <% end %>
      </div>
    </div>

      <!-- Button trigger modal -->
    <div>
      <button type="button" class="green-btn" id="add-review" data-toggle="modal" data-target="#reviewModal">
        Add a review
      </button>
    </div>

    <%= render "/shared/modalreview", brand: @brand, review: @review, display_modal: @display_modal %>
  </div>


  <br>

  <div class="overall-score-container">
    <div class="team-score">
      <p><strong>Our team's score</strong></p>
      <p><%= @brand.overall_score.to_f.round(1) %>/5 </p>

      <% @brand.overall_score.to_i.times do %>
       <i class="fas fa-star"></i>
      <% end %>

      <% if (@brand.overall_score - @brand.overall_score.to_i) >= 0.5 %>
        <i class="fas fa-star-half-alt"></i>
      <% end %>
      <% (5 - @brand.overall_score.round).times do %>
       <i class="far fa-star"></i>
      <% end %>
    </div>

    <div class="consumer-score">
      <p><strong>Our consumer's score</strong></p>
      <p><%= @brand.overall_score.to_f.round(1) %>/5 </p>

      <% @brand.overall_score.to_i.times do %>
        <i class="fas fa-star"></i>
      <% end %>

      <% if (@brand.overall_score - @brand.overall_score.to_i) >= 0.5 %>
        <i class="fas fa-star-half-alt"></i>
      <% end %>

      <% (5 - @brand.overall_score.round).times do %>
       <i class="far fa-star"></i>
      <% end %>
    </div>
  </div>

  <br>

  <h3>Scores</h3>


  <% if @brand.quality_score == nil%>
    <p>Quality score : <i>missing info</i> </p>
    <% else %>
    <p>Quality score : <%= @brand.quality_score  %>/5 </p>
  <% end %>
  <p>Social score : <%= @brand.social_score %>/5</p>
  <p>Environmental score : <%= @brand.environmental_score %>/5 </p>

  <br>
  
<div class="sentiment-card">
  <%= link_to "Get the sentiment of users", brand_brand_analyse_path(@brand) %>
  <div class="">
    <% if @brand.nlp.nil? %>
      <%= "No sentiment for now" %>
    <% else %>
      <div>
        Sentiment: <strong><%= @brand.nlp.sentiment_label %></strong> <br>
        <% if @brand.nlp.sentiment_score >= 0 %>
          <sl-progress-ring size="200" stroke-width="10" percentage=<%= @brand.nlp.sentiment_score * 100 %> > <%= (@brand.nlp.sentiment_score * 100).round(1) %> % </sl-progress-ring>
        <% else %>
          <sl-progress-ring style="--track-color: #ffe2c6; --indicator-color: tomato;" size="200" stroke-width="10" percentage=<%= @brand.nlp.sentiment_score * 100 %> > <%= (@brand.nlp.sentiment_score * 100).round(1) %> % </sl-progress-ring>
        <% end %>
      </div>
        Sadness
        <div class="progress">
          <div class="progress-bar bg-info" role="progressbar" style="width: <%= @brand.nlp.sadness * 100 %>%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"><%= (@brand.nlp.sadness * 100).round(1) %>%</div>
        </div>
        Joy
        <div class="progress">
          <div class="progress-bar" role="progressbar" style="width: <%= @brand.nlp.joy * 100 %>%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"><%= (@brand.nlp.joy * 100).round(1) %>%</div>
        </div>
        Fear
        <div class="progress">
          <div class="progress-bar bg-warning" role="progressbar" style="width: <%= @brand.nlp.fear * 100 %>%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"><%= (@brand.nlp.fear * 100).round(1) %>%</div>
        </div>
        Disgust
        <div class="progress">
          <div class="progress-bar bg-success" role="progressbar" style="width: <%= @brand.nlp.disgust * 100 %>%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"><%= (@brand.nlp.disgust * 100).round(1) %>%</div>
        </div>
        Anger
        <div class="progress">
          <div class="progress-bar bg-danger" role="progressbar" style="width: <%= @brand.nlp.anger * 100 %>%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"><%= (@brand.nlp.anger * 100).round(1) %>%</div>          
        </div>
      <% end %>
    </div>
  </div>






  Reviews

  <ul>
    <% @brand.reviews.each do |review| %>
      <li>
        <strong><%= review.title %></strong> - <%= review.score %> <br>
        <%= review.content %>

      </li>
    <% end %>
  </ul>


  <h3>Latest news</h3>

  <h3>Discover more brands</h3>

</div>


